/*!
 * Copyright 2017 by monad
 */
!function(t){var n=["#96C2F1","#BBE1F1","#E3E197","#F8B3D0","#FFCC00"],e=function(e){var s=n[parseInt(5*Math.random(),10)];t('<div class="item"><p>'+e.msg+'</p><p class="nm">网友：'+e.name+" "+e.gift+'<a href="#">x</a></p></div>').css({background:s}).appendTo(container).drag()};t.fn.drag=function(){var n,e,s,i,a=t(this),o=a.parent(),r=o.width(),c=o.height(),p=a.width()+parseInt(a.css("padding-left"),10)+parseInt(a.css("padding-right"),10),h=a.height()+parseInt(a.css("padding-top"),10)+parseInt(a.css("padding-bottom"),10),u=!1,f=parseInt(Math.random()*(c-h),10),d=parseInt(Math.random()*(r-p),10);o.css({position:"relative",overflow:"hidden"}),a.css({cursor:"move",position:"absolute"}).css({top:f,left:d}).mousedown(function(t){return o.children().css({zIndex:"0"}),a.css({zIndex:"1"}),u=!0,n=t.pageX,e=t.pageY,s=a.position().left,i=a.position().top,!1}),t(document).mouseup(function(t){u=!1}).mousemove(function(t){var o=t.pageX,f=s+o-n,d=t.pageY,m=i+d-e;1==u&&(a.css({left:f,top:m}),f<0&&a.css({left:"0"}),f>r-p&&a.css({left:r-p}),m<0&&a.css({top:"0"}),m>c-h&&a.css({top:c-h}))})};var s=function(){var n=t("#container");n.on("click","a",function(n){n.preventDefault(),t(this).parents(".item").remove()}).height(t(window).height()-204),t.get("msg.json",function(n,s){t.each(n,function(t,n){e(n)})}),t("#msgForm").submit(function(n){n.preventDefault(),t.fn.serializeObject=function(){var n={},e=this.serializeArray();return t.each(e,function(){void 0!==n[this.name]?(n[this.name].push||(n[this.name]=[n[this.name]]),n[this.name].push(this.value||"")):n[this.name]=this.value||""}),n};var s=JSON.stringify(t(this).serializeObject());if(console.log(s),console.log(typeof s),t.ajax({url:t(this).attr("action"),type:t(this).attr("method"),data:s,success:function(t){},error:function(t){}}),s){var i=t.parseJSON(s);e(i),t(this).find("input, textarea").not(":radio").val("")}})};t(function(){s()})}(jQuery);